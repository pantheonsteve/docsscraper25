{% extends 'dashboard/base.html' %}

{% block title %}Raw HTML - {{ page.title }} - DocAnalyzer{% endblock %}

{% block content %}
<style>
    .html-viewer {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 2rem;
        border-radius: 8px;
        margin: 2rem 0;
        overflow-x: auto;
        font-family: 'Courier New', monospace;
        font-size: 0.875rem;
        line-height: 1.6;
        max-height: calc(100vh - 300px);
        overflow-y: auto;
    }
    
    .html-viewer pre {
        margin: 0;
        white-space: pre-wrap;
        word-break: break-word;
    }
    
    .page-info {
        background: white;
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .action-bar {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
    }
    
    .btn {
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-weight: 600;
        text-decoration: none;
        display: inline-block;
        transition: all 0.2s;
        border: none;
        cursor: pointer;
    }
    
    .btn-primary {
        background: #667eea;
        color: white;
    }
    
    .btn-primary:hover {
        background: #5568d3;
        transform: translateY(-2px);
    }
    
    .btn-secondary {
        background: #95a5a6;
        color: white;
    }
    
    .btn-secondary:hover {
        background: #7f8c8d;
    }
    
    .btn-success {
        background: #27ae60;
        color: white;
    }
    
    .btn-success:hover {
        background: #229954;
    }
    
    .stats {
        display: flex;
        gap: 2rem;
        margin-top: 1rem;
        flex-wrap: wrap;
    }
    
    .stat-item {
        display: flex;
        flex-direction: column;
    }
    
    .stat-label {
        font-size: 0.85rem;
        color: #7f8c8d;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .stat-value {
        font-size: 1.25rem;
        font-weight: 700;
        color: #2c3e50;
    }
</style>

<div class="action-bar">
    <a href="{% url 'dashboard:page_detail' page.id %}" class="btn btn-secondary">‚Üê Back to Page Detail</a>
    <a href="{{ page.url }}" target="_blank" class="btn btn-primary">View Live Page ‚Üí</a>
    <button onclick="copyToClipboard()" class="btn btn-success">üìã Copy HTML</button>
</div>

<div class="page-info">
    <h1 style="font-size: 1.5rem; margin-bottom: 0.5rem; color: #2c3e50;">{{ page.title|default:"Untitled Page" }}</h1>
    <div style="color: #7f8c8d; font-size: 0.95rem; margin-bottom: 1rem; word-break: break-all;">{{ page.url }}</div>
    
    <div class="stats">
        <div class="stat-item">
            <span class="stat-label">HTML Size</span>
            <span class="stat-value">{{ page.raw_html|length|filesizeformat }}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">Lines</span>
            <span class="stat-value">{{ page.raw_html|linebreaksbr|length }}</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">Crawled</span>
            <span class="stat-value">{{ page.crawled_at|date:"M d, Y" }}</span>
        </div>
    </div>
</div>

<div id="html-content" class="html-viewer">
    <pre>{{ page.raw_html }}</pre>
</div>

<script>
function copyToClipboard() {
    const htmlContent = document.getElementById('html-content').innerText;
    navigator.clipboard.writeText(htmlContent).then(function() {
        alert('HTML copied to clipboard!');
    }, function(err) {
        alert('Failed to copy: ' + err);
    });
}
</script>

{% endblock %}

